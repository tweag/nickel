# test.type = 'pass'

let {string, ..} = std in

[
  # string.contains
  string.contains "" "",
  string.contains "_" "__",
  string.contains "\n" "\n\n\n",
  !(string.contains "\n" "\r"),
  !(string.contains "_" "no underscores"),
  !(string.contains "â¤" "ğŸ‘¨â€â¤ï¸â€ğŸ’‹â€ğŸ‘¨"),
  !(string.contains "wordsğŸ‘¨" "wordsğŸ‘¨â€â¤ï¸â€ğŸ’‹â€ğŸ‘¨"),

  # string.replace
  string.replace "" "a" "bnn" == "abanana",
  string.replace "the present" "the future" "the present is now" == "the future is now",
  string.replace "iron" "nickel" "iron man" == "nickel man",
  string.replace "nickel" "iron" "iron man" == "iron man",
  string.replace "â¤" "egg" "ğŸ‘¨â€â¤ï¸â€ğŸ’‹â€ğŸ‘¨" == "ğŸ‘¨â€â¤ï¸â€ğŸ’‹â€ğŸ‘¨",
  string.replace "has" "had" "this has multiple matches, has it?" == "this had multiple matches, had it?",
  string.replace "helloğŸ‘¨" "goodbye" "helloğŸ‘¨â€â¤ï¸â€ğŸ’‹â€ğŸ‘¨" == "helloğŸ‘¨â€â¤ï¸â€ğŸ’‹â€ğŸ‘¨",

  # string.replace_regex
  string.replace_regex "\\d" "_" "1,234,1 1" == "_,___,_ _",
  string.replace_regex "\\d+" "_" "1,234,1 1" == "_,_,_ _",
  string.replace_regex "\\d" "_" "ï¼‘ï¼’ï¼“" == "___",
  string.replace_regex "\\d" "_" "ä¸€äºŒä¸‰" == "ä¸€äºŒä¸‰",
  # we don't want to replace codepoints inside extended grapheme clusters
  string.replace_regex "â¤ï¸" "_" "ğŸ‘¨â€â¤ï¸â€ğŸ’‹â€ğŸ‘¨" == "ğŸ‘¨â€â¤ï¸â€ğŸ’‹â€ğŸ‘¨",
  string.replace_regex "â¤ï¸" "_" "xâ¤ï¸yâ¤ï¸z" == "x_y_z",

  # string.is_match
  string.is_match "^___$" "___",
  string.is_match "___" "___)",
  !(string.is_match "^___$" "___)"),
  # we don't want matches if they occur as part of an extended grapheme cluster
  !(string.is_match "ğŸ‘¨" "ğŸ‘¨â€â¤ï¸â€ğŸ’‹â€ğŸ‘¨"),
  !(string.is_match "â¤ï¸" "ğŸ‘¨â€â¤ï¸â€ğŸ’‹â€ğŸ‘¨"),

  # string.find
  string.find "([0-9]{1,3}\\.){3}([0-9]{1,3})" "1.2.3.4" == { matched = "1.2.3.4", index = 0, groups = ["3.", "4"]},
  string.find "([0-9]{1,3})\\.([0-9]{1,3})\\.([0-9]{1,3})\\.([0-9]{1,3})" "ip: 192.168.1.4, sorry, what's ipv6?" == { matched = "192.168.1.4", index = 4, groups = ["192", "168", "1", "4"]},
  string.find "\\d" "no numeral" == { matched = "", index = -1, groups = []},
  string.find "â¤ï¸" "ğŸ‘¨â€â¤ï¸â€ğŸ’‹â€ğŸ‘¨" == { matched = "", index = -1, groups = []},
  string.find "â¤ï¸" "ğŸ‘¨â€â¤ï¸â€ğŸ’‹â€ğŸ‘¨â¤ï¸" == { matched = "â¤ï¸", index = 1, groups = [] },
  ] |> std.test.assert_all
